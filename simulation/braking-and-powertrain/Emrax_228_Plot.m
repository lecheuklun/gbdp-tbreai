Speed = [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,398,399,400,401,402,403,404,405,406,407,408,409,410,411,412,413,414,415,416,417,418,419,420,421,422,423,424,425,426,427,428,429,430,431,432,433,434,435,436,437,438,439,440,441,442,443,444,445,446,447,448,449,450,451,452,453,454,455,456,457,458,459,460,461,462,463,464,465,466,467,468,469,470,471,472,473,474,475,476,477,478,479,480,481,482,483,484,485,486,487,488,489,490,491,492,493,494,495,496,497,498,499,500]*10;
Peak_Torque = [240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,239.925,239.846,239.767,239.689,239.61,239.531,239.47,239.428,239.386,239.344,239.303,239.261,239.219,239.177,239.135,239.093,239.051,239.009,238.968,238.926,238.884,238.819,238.693,238.567,238.442,238.316,238.19,238.065,237.939,237.814,237.688,237.562,237.437,237.311,237.185,237.06,236.943,236.943,236.943,236.943,236.943,236.943,236.943,236.943,236.943,236.943,236.943,236.943,236.943,236.943,236.943,236.915,236.834,236.753,236.672,236.591,236.509,236.428,236.347,236.266,236.185,236.103,236.022,235.941,235.86,235.778,235.697,235.633,235.579,235.524,235.469,235.414,235.36,235.305,235.25,235.196,235.141,235.086,235.032,234.977,234.922,234.867,234.813,234.758,234.703,234.649,234.594,234.539,234.485,234.43,234.375,234.319,234.263,234.207,234.151,234.096,234.04,233.984,233.928,233.872,233.816,233.761,233.705,233.649,233.593,233.537,233.481,233.425,233.37,233.314,233.258,233.202,233.146,233.069,232.973,232.877,232.781,232.686,232.59,232.494,232.399,232.303,232.207,232.111,232.016,231.92,231.824,231.728,231.633,231.537,231.441,231.346,231.25,231.154,231.058,230.963,230.867,230.771,230.676,230.58,230.508,230.437,230.366,230.296,230.225,230.155,230.084,230.014,229.943,229.873,229.802,229.732,229.661,229.591,229.52,229.45,229.379,229.308,229.238,229.167,229.097,229.026,228.956,228.885,228.815,228.744,228.674,228.592,228.508,228.425,228.341,228.257,228.173,228.089,228.006,227.922,227.838,227.754,227.671,227.587,227.503,227.419,227.336,227.252,227.168,227.084,227.001,226.917,226.833,226.749,226.666,226.582,226.498,226.414,226.331,226.247,226.163,226.056,225.916,225.777,225.637,225.497,225.358,225.218,225.079,224.939,224.799,224.66,224.52,224.381,224.241,224.101,223.962,223.822,223.683,223.543,223.403,223.264,223.124,222.985,222.828,222.661,222.493,222.325,222.158,221.99,221.823,221.655,221.488,221.32,221.153,220.985,220.818,220.65,220.483,220.315,220.148,219.98,219.813,219.645,219.478,219.31,219.143,219.028,218.928,218.827,218.727,218.626,218.526,218.425,218.325,218.224,218.124,218.023,217.923,217.822,217.722,217.621,217.521,217.42,217.32,217.219,217.132,217.048,216.964,216.881,216.797,216.713,216.629,216.534,216.385,216.236,216.087,215.938,215.803,215.684,215.551];
Continuous_Torque = [95.716,96.067,96.4,96.716,97.015,97.299,97.569,97.826,98.072,98.307,98.533,98.751,98.963,99.168,99.369,99.567,99.763,99.958,100.153,100.349,100.549,100.752,100.959,101.17,101.384,101.602,101.822,102.045,102.27,102.497,102.725,102.954,103.184,103.414,103.645,103.875,104.105,104.334,104.561,104.788,105.013,105.237,105.46,105.683,105.905,106.127,106.349,106.571,106.794,107.017,107.24,107.465,107.689,107.914,108.138,108.363,108.587,108.81,109.033,109.254,109.475,109.694,109.911,110.127,110.342,110.554,110.765,110.973,111.18,111.385,111.587,111.787,111.985,112.181,112.374,112.564,112.752,112.937,113.119,113.298,113.474,113.647,113.817,113.984,114.147,114.307,114.465,114.619,114.77,114.919,115.065,115.209,115.351,115.491,115.629,115.766,115.9,116.034,116.166,116.297,116.428,116.557,116.686,116.815,116.943,117.071,117.199,117.327,117.455,117.583,117.711,117.838,117.964,118.089,118.213,118.335,118.456,118.576,118.693,118.808,118.921,119.032,119.139,119.244,119.346,119.444,119.539,119.63,119.718,119.801,119.88,119.957,120.031,120.102,120.172,120.24,120.309,120.376,120.445,120.514,120.585,120.658,120.733,120.812,120.894,120.98,121.071,121.166,121.266,121.369,121.475,121.584,121.695,121.808,121.922,122.037,122.152,122.267,122.381,122.494,122.606,122.715,122.822,122.926,123.026,123.123,123.214,123.301,123.383,123.458,123.527,123.589,123.645,123.694,123.737,123.775,123.809,123.839,123.866,123.891,123.913,123.935,123.956,123.977,123.998,124.021,124.046,124.074,124.105,124.139,124.178,124.223,124.272,124.327,124.386,124.449,124.516,124.587,124.66,124.736,124.814,124.894,124.975,125.057,125.14,125.222,125.305,125.387,125.468,125.547,125.625,125.7,125.772,125.842,125.908,125.97,126.028,126.081,126.129,126.172,126.21,126.243,126.272,126.296,126.316,126.332,126.344,126.353,126.358,126.36,126.36,126.356,126.351,126.343,126.333,126.321,126.308,126.294,126.278,126.262,126.245,126.227,126.209,126.191,126.174,126.156,126.14,126.124,126.109,126.096,126.083,126.072,126.062,126.053,126.046,126.039,126.033,126.028,126.024,126.021,126.019,126.018,126.018,126.019,126.02,126.022,126.025,126.029,126.033,126.038,126.044,126.05,126.057,126.064,126.072,126.081,126.09,126.099,126.109,126.12,126.13,126.141,126.152,126.162,126.172,126.182,126.191,126.199,126.206,126.212,126.216,126.219,126.22,126.219,126.216,126.211,126.203,126.193,126.18,126.164,126.145,126.123,126.097,126.068,126.036,126,125.962,125.92,125.876,125.829,125.78,125.729,125.675,125.62,125.563,125.503,125.443,125.38,125.317,125.252,125.187,125.12,125.053,124.985,124.916,124.847,124.778,124.709,124.64,124.572,124.504,124.436,124.37,124.304,124.239,124.176,124.114,124.054,123.996,123.94,123.885,123.834,123.784,123.737,123.694,123.653,123.615,123.581,123.55,123.522,123.498,123.476,123.456,123.437,123.42,123.404,123.389,123.374,123.358,123.341,123.324,123.305,123.284,123.261,123.235,123.205,123.173,123.136,123.095,123.049,122.998,122.942,122.879,122.811,122.738,122.66,122.579,122.493,122.405,122.314,122.222,122.128,122.033,121.938,121.843,121.748,121.655,121.564,121.475,121.389,121.306,121.227,121.153,121.084,121.02,120.962,120.909,120.861,120.817,120.776,120.738,120.701,120.666,120.631,120.596,120.56,120.522,120.483,120.44,120.393,120.342,120.287,120.227,120.163,120.095,120.023,119.947,119.867,119.784,119.698,119.608,119.514,119.418,119.319,119.217,119.112,119.004,118.894,118.782,118.667,118.551,118.432,118.312,118.189,118.066,117.94,117.814,117.686,117.557,117.427,117.298,117.168,117.038,116.909,116.781,116.653,116.527,116.403,116.281,116.161,116.043,115.929,115.817,115.708,115.602,115.497,115.395,115.294,115.194,115.095,114.997,114.898,114.8,114.701,114.601,114.5,114.397,114.293,114.186,114.077,113.966,113.851,113.733,113.613,113.491,113.366,113.239,113.11,112.98,112.848,112.714,112.579,112.443,112.306,112.168,112.03,111.891,111.753,111.613,111.474,111.336,111.197,111.06,110.923,110.788,110.654,110.522,110.392,110.264,110.172,110.062];
Peak_Power = [0,2.46,3.264,4.068,4.872,5.677,6.481,7.286,8.09,8.895,9.699,10.503,11.307,12.111,12.915,13.718,14.521,15.324,16.127,16.929,17.73,18.53,19.33,20.129,20.927,21.724,22.52,23.315,24.108,24.9,25.69,26.479,27.266,28.052,28.836,29.617,30.397,31.174,31.95,32.723,33.493,34.262,35.027,35.79,36.55,37.308,38.062,38.814,39.562,40.307,41.05,41.79,42.527,43.261,43.993,44.723,45.45,46.176,46.899,47.62,48.34,49.058,49.774,50.489,51.203,51.915,52.626,53.337,54.046,54.755,55.462,56.17,56.876,57.583,58.289,58.995,59.701,60.407,61.114,61.82,62.527,63.235,63.943,64.652,65.362,66.073,66.785,67.498,68.212,68.928,69.645,70.364,71.085,71.807,72.532,73.258,73.987,74.718,75.452,76.188,76.926,77.668,78.412,79.159,79.909,80.662,81.419,82.178,82.939,83.704,84.47,85.239,86.011,86.784,87.559,88.336,89.114,89.894,90.676,91.458,92.242,93.027,93.813,94.599,95.386,96.173,96.961,97.749,98.537,99.325,100.113,100.9,101.687,102.474,103.259,104.044,104.828,105.611,106.392,107.172,107.951,108.728,109.503,110.276,111.048,111.817,112.584,113.348,114.11,114.869,115.625,116.379,117.129,117.876,118.62,119.362,120.1,120.836,121.569,122.299,123.028,123.754,124.479,125.202,125.923,126.642,127.36,128.077,128.793,129.508,130.222,130.935,131.648,132.36,133.072,133.784,134.496,135.208,135.921,136.634,137.348,138.062,138.777,139.494,140.211,140.93,141.65,142.372,143.095,143.821,144.548,145.278,146.01,146.744,147.481,148.221,148.964,149.709,150.456,151.207,151.96,152.715,153.473,154.233,154.995,155.759,156.526,157.294,158.065,158.837,159.612,160.388,161.166,161.945,162.726,163.509,164.293,165.079,165.865,166.654,167.443,168.234,169.025,169.818,170.612,171.406,172.202,172.998,173.795,174.592,175.391,176.189,176.988,177.788,178.588,179.388,180.188,180.989,181.789,182.59,183.39,184.191,184.991,185.791,186.591,187.39,188.189,188.987,189.785,190.582,191.379,192.174,192.969,193.763,194.556,195.349,196.14,196.929,197.718,198.506,199.292,200.076,200.86,201.641,202.422,203.2,203.977,204.752,205.525,206.297,207.066,207.833,208.598,209.362,210.122,210.881,211.637,212.391,213.142,213.888,214.629,215.363,216.088,216.803,217.507,218.199,218.876,219.538,220.184,220.811,221.419,222.006,222.577,223.139,223.698,224.264,224.844,225.445,226.073,226.725,227.396,228.081,228.773,229.468,230.161,230.844,231.514,232.163,232.787,233.389,233.982,234.579,235.195,235.842,236.524,237.222,237.918,238.594,239.228,239.805,240.326,240.816,241.295,241.789,242.319,242.907,243.557,244.243,244.939,245.617,246.252,246.837,247.38,247.887,248.365,248.823,249.266,249.703,250.14,250.585,251.038,251.497,251.956,252.414,252.867,253.311,253.742,254.157,254.556,254.946,255.337,255.74,256.165,256.622,257.119,257.653,258.213,258.791,259.378,259.966,260.548,261.121,261.687,262.243,262.791,263.328,263.855,264.372,264.878,265.373,265.857,266.333,266.8,267.258,267.709,268.153,268.59,269.021,269.446,269.865,270.278,270.685,271.086,271.482,271.872,272.257,272.637,273.012,273.384,273.753,274.121,274.49,274.86,275.233,275.611,275.993,276.378,276.758,277.126,277.474,277.794,278.08,278.324,278.523,278.696,278.873,279.08,279.346,279.698,280.146,280.654,281.185,281.698,282.156,282.528,282.826,283.07,283.282,283.485,283.693,283.908,284.13,284.36,284.597,284.842,285.091,285.342,285.589,285.827,286.052,286.262,286.464,286.661,286.861,287.068,287.287,287.522,287.771,288.027,288.289,288.55,288.806,289.055,289.29,289.514,289.731,289.947,290.168,290.399,290.645,290.9,291.156,291.402,291.631,291.833,292.008,292.163,292.306,292.445,292.585,292.735,292.901,293.092,293.306,293.536,293.775,294.015,294.248,294.467,294.664,294.83,294.96,295.055,295.13,295.199,295.276,295.375,295.511,295.695,295.923,296.179,296.45,296.722,296.982,297.216,297.409,297.551,297.652,297.735,297.821,297.934,298.095,298.318,298.582,298.858,299.117,299.329,299.466,299.493,299.373,300]*(109/300);
Continuous_Power = [0,0.394,0.789,1.183,1.577,1.972,2.366,2.76,3.154,3.549,3.943,4.337,4.732,5.126,5.52,5.915,6.309,6.703,7.098,7.492,7.886,8.281,8.675,9.069,9.463,9.858,10.252,10.646,11.041,11.435,11.829,12.224,12.618,13.012,13.407,13.801,14.195,14.59,14.984,15.378,15.772,16.167,16.561,16.955,17.35,17.744,18.138,18.533,18.927,19.321,19.716,20.11,20.504,20.899,21.293,21.687,22.081,22.476,22.87,23.264,23.659,24.053,24.447,24.842,25.236,25.63,26.025,26.419,26.813,27.208,27.602,27.996,28.39,28.785,29.179,29.573,29.968,30.362,30.756,31.151,31.545,31.939,32.334,32.728,33.122,33.517,33.911,34.305,34.699,35.094,35.488,35.882,36.277,36.671,37.065,37.46,37.854,38.248,38.643,39.037,39.431,39.825,40.22,40.614,41.008,41.403,41.797,42.191,42.586,42.98,43.374,43.769,44.163,44.557,44.952,45.346,45.74,46.134,46.529,46.923,47.317,47.712,48.106,48.5,48.895,49.289,49.683,50.078,50.472,50.866,51.261,51.655,52.049,52.443,52.838,53.232,53.626,54.021,54.415,54.809,55.204,55.598,55.992,56.387,56.781,57.175,57.57,57.964,58.358,58.752,59.147,59.541,59.935,60.33,60.724,61.118,61.513,61.907,62.301,62.696,63.09,63.484,63.879,64.273,64.667,65.061,65.456,65.85,66.244,66.639,67.033,67.427,67.822,68.216,68.61,69.005,69.399,69.793,70.188,70.582,70.976,71.37,71.765,72.159,72.553,72.948,73.342,73.736,74.131,74.525,74.919,75.314,75.708,76.102,76.496,76.891,77.285,77.679,78.074,78.468,78.862,79.257,79.651,80.045,80.44,80.834,81.228,81.623,82.017,82.411,82.805,83.2,83.594,83.988,84.383,84.777,85.171,85.566,85.96,86.354,86.749,87.143,87.537,87.932,88.326,88.72,89.114,89.509,89.903,90.297,90.692,91.086,91.48,91.875,92.269,92.663,93.058,93.452,93.846,94.241,94.639,95.038,95.437,95.836,96.234,96.633,97.032,97.431,97.83,98.229,98.628,99.026,99.425,99.824,100.223,100.622,101.021,101.419,101.818,102.217,102.616,103.015,103.414,103.813,104.211,104.61,105.009,105.408,105.807,106.206,106.604,107.003,107.402,107.801,108.2,108.599,108.998,109.396,109.795,110.194,110.596,110.998,111.4,111.802,112.204,112.606,113.008,113.41,113.812,114.215,114.617,115.019,115.421,115.823,116.225,116.627,117.029,117.431,117.833,118.149,118.464,118.779,119.094,119.41,119.725,120.04,120.356,120.792,121.238,121.685,122.132,122.578,123.025,123.472,123.796,124.088,124.379,124.67,124.962,125.253,125.544,125.836,126.127,126.418,126.709,127.079,127.462,127.845,128.228,128.611,128.994,129.377,129.759,130.142,130.525,130.908,131.291,131.674,132.04,132.393,132.746,133.098,133.451,133.804,134.156,134.509,134.862,135.178,135.46,135.742,136.024,136.306,136.588,136.871,137.153,137.435,137.766,138.149,138.532,138.915,139.298,139.68,140.063,140.446,140.829,141.212,141.555,141.86,142.164,142.469,142.774,143.078,143.383,143.687,143.992,144.296,144.602,144.924,145.245,145.567,145.888,146.21,146.532,146.853,147.175,147.497,147.818,148.14,148.45,148.701,148.952,149.204,149.455,149.706,149.957,150.209,150.456,150.699,150.943,151.187,151.43,151.663,151.875,152.086,152.298,152.51,152.721,152.933,153.144,153.356,153.564,153.765,153.966,154.167,154.368,154.569,154.77,154.971,155.172,155.374,155.592,155.816,156.039,156.262,156.486,156.709,156.932,157.156,157.366,157.533,157.701,157.868,158.036,158.203,158.371,158.538,158.697,158.85,159.003,159.156,159.309,159.462,159.616,159.769,159.922,160.075,160.228,160.381,160.534,160.688,160.841,160.994,161.147,161.288,161.429,161.57,161.711,161.852,161.993,162.134,162.276,162.417,162.545,162.672,162.8,162.928,163.055,163.183,163.31,163.438,163.566,163.693,163.899,164.105,164.311,164.517,164.724,164.93,165.089,165.238,165.387,165.536,165.685,165.834,165.983,166.132,166.3,166.523,166.746,166.97,167.193,167.417,167.64,167.863,168.087,168.239,168.36,168.482,168.604,168.726,168.841]*(109/300);

P = [Speed;Peak_Torque;Continuous_Torque;Peak_Power;Continuous_Power];


for i = 1:1:501
    if i > 5
        if mod(i-1,10) == 0
        z((i-1)/10,1) = Speed(i);
        z((i-1)/10,2) = Peak_Torque(i);
        end
    end
end
cla reset
figure(1)
hold on
title('EMRAX 228 Torque and Power Characteristics vs Speed')
xlabel('Speed /rpm') 
yyaxis left
ylabel ('Torque /Nm')
plot(Speed,Peak_Torque)
xlim([0 5000])
ylim([0 300])

plot(Speed,Continuous_Torque)

yyaxis right
ylabel('Power /kW')
plot(Speed,Peak_Power)
plot(Speed,Continuous_Power)
% xlswrite('Peak_Torque.xlsx',Peak_Power)
legend('Peak Torque','Continuous Torque','Peak Power','Continuous Power')
legend('Location','southeast')
hold off